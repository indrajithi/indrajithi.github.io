<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Machine Learning Approach to Classify Music Based on Genre | Blog of Indrajith Indraprastham</title><meta name=keywords content><meta name=description content="Music Genre Classifier Demo Table of Contents  Introduction Requirements Installation Music Genre Classifier App Architecture Flow Chart Prototype  Feature Extraction Principal Component Analysis. Dimensionality reduction Classification  K-nearest neighbors (KNN) Logistic Regression     Python package mysvm  feature svm acc   Results Conclusion License  Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased."><meta name=author content="Indrajith Indraprastham"><link rel=canonical href=https://indrajithi.github.io/posts/machine-learning-pproach-to-classify-music-based-on-genre/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.65aebb33e4f0ce3d1a39e4a35c11b91eb08b582489fca0f78f9227d90ac72a52.css integrity="sha256-Za67M+Twzj0aOeSjXBG5HrCLWCSJ/KD3j5In2QrHKlI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.1"><meta property="og:title" content="Machine Learning Approach to Classify Music Based on Genre"><meta property="og:description" content="Music Genre Classifier Demo Table of Contents  Introduction Requirements Installation Music Genre Classifier App Architecture Flow Chart Prototype  Feature Extraction Principal Component Analysis. Dimensionality reduction Classification  K-nearest neighbors (KNN) Logistic Regression     Python package mysvm  feature svm acc   Results Conclusion License  Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased."><meta property="og:type" content="article"><meta property="og:url" content="https://indrajithi.github.io/posts/machine-learning-pproach-to-classify-music-based-on-genre/"><meta property="og:image" content="https://indrajithi.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-07-29T11:58:29+05:30"><meta property="article:modified_time" content="2017-07-29T11:58:29+05:30"><meta property="og:site_name" content="Blog of Indrajith Indraprastham"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://indrajithi.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Machine Learning Approach to Classify Music Based on Genre"><meta name=twitter:description content="Music Genre Classifier Demo Table of Contents  Introduction Requirements Installation Music Genre Classifier App Architecture Flow Chart Prototype  Feature Extraction Principal Component Analysis. Dimensionality reduction Classification  K-nearest neighbors (KNN) Logistic Regression     Python package mysvm  feature svm acc   Results Conclusion License  Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://indrajithi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Machine Learning Approach to Classify Music Based on Genre","item":"https://indrajithi.github.io/posts/machine-learning-pproach-to-classify-music-based-on-genre/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Machine Learning Approach to Classify Music Based on Genre","name":"Machine Learning Approach to Classify Music Based on Genre","description":"Music Genre Classifier Demo Table of Contents  Introduction Requirements Installation Music Genre Classifier App Architecture Flow Chart Prototype  Feature Extraction Principal Component Analysis. Dimensionality reduction Classification  K-nearest neighbors (KNN) Logistic Regression     Python package mysvm  feature svm acc   Results Conclusion License  Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased.","keywords":[],"articleBody":"Music Genre Classifier Demo Table of Contents  Introduction Requirements Installation Music Genre Classifier App Architecture Flow Chart Prototype  Feature Extraction Principal Component Analysis. Dimensionality reduction Classification  K-nearest neighbors (KNN) Logistic Regression     Python package mysvm  feature svm acc   Results Conclusion License  Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased.\nMusical genres have no strict definitions and boundaries as they arise through a complex interaction between the public, marketing, historical, and cultural factors. We are going to create an application that accepts a music file and classify it in to genres.\nRequirements  Django (1.11) Numpy (1.12.1) Scikit-Learn (0.18.1) Scipy (0.19.0) Python-Speech-Features (0.5) Pydub (0.18.0)  Installation  git clone https://github.com/indrajithi/mgc-django.git pip install -r requirements.txt python manage.py migrate python manage.py runserver App will run on localhost:8000  Music Genre Classifier Our app is written in Python using Django framework. We are using a trained Poly Kernel SVM for finding the genre.\nOur web application uses the package mysvm which we developed to extract features and to find the genre.\nFlow Chart We have developed a python package called mysvm for extracting features and classifying music. This package is added to our App. On receiving a request for genre label, we convert the file to .wav if it is in other format. Then the features are extracted from the audio file using mysvm.feature.extract (filename). Genre labels can be found by mysvm.svm.getGenre(filename) function call. If multi option is selected by the user then mysvm.svm.getMultiGenre(filename) function is called.\nPrototype We need to find the best classification algorithm that can be used in our App. Matlab is ideal to implement machine learning algorithms in minimum lines of code. Before making the App in python we made a prototype in Matlab.\nFeature Extraction We chose to extract MFCC from the audio files as the feature. For finding MFCC in Matlab, we have used HTK MFCC MATLAB toolkit. The output will be a matrix of 13n dimensional vector. Where n depends on the total duration of the audio. 13(100*sec).\nWhile feature extraction we were getting ‘nan’(not a number) and infinity in the output. This is usually caused be a division by zero or a very small number closed to 0 resulting in infinity/nan in the output. This could be a regular result or some algorithm or implementation error in the MFCC toolkit. To overcome this situation, we have set nan or infinity entries in the feature array to 0.\nPrincipal Component Analysis. Principal component analysis (PCA) is a statistical procedure that uses an orthogonal transformation to convert a set of observations of possibly correlated variables into a set of values of linearly uncorrelated variables called principal components (or sometimes, principal modes of variation) [7]. After doing a PCA on the data we got 90% variance and should reduce the feature dimension.\n[input2, eigvec, eigvalue] = pca (ds. input); cumvar = cumsum(eigvalue); //cumulative sum n(n+1)/2 cumvarpercent = cumvar/cumvar(end)*100; Dimensionality reduction Various researchers take statistics such as mean variance IQR, etc., to reduce the feature dimension. Some researchers model it using multivariate regression and some fit it to a Gaussian mixture model. Here we are taking the mean and upper diagonal variance of 13*n MFCC coefficients. The result is a feature vector of size 104.\n%Reducing Feature Dimeansion mf = mean(mm,2); %row mean cf = cov(mm'); % covariance ff = mf; for i=0:(size(mm,1)-1) ff = [ff;diag(cf,i)]; %use diagonals  end t(:,end+1) = ff(:,1); Classification K-nearest neighbors (KNN) Principle is that the data instance of the same class should be closer in the feature space. For a given data point x of unknown class, we can compute the distance between x and all the data points in the training data and assign the class determined by k nearest points of x.\nSuppose we are given training dataset of n points. {(x1,y1),(x2,y2)…(xn,yn)} Where (xi,yi) represents data pair i. xi- feature vector yi- target class For a new data point x the most likely class is determined by finding the distance from all training data points (Euclidian distance). The output class will be the class which k nearest neighbors belongs to. K is a predefined integer (k=1, k=2, k=3.)\nLogistic Regression Logistic Regression is one of the widely used classification algorithm. This algorithm is used in medical as well as business fields for analytics and classification. This model has the hypothesis function 0 ≤h (x) ≤ 1. Where hθ(x) = 11 + e-θTx called as Sigmoid or Logistic Function. For binary class classification y ∈{0, 1}. The output of this classifier will be a probability of the given input belonging to class 1. Ifhθ(x)outputs 0.7 it means that the given input has 70% chance of belonging to class 1. Since we have 10 genre classes y ∈{0, 1 .. 9}we used one-vs-all method for classification.\nPython package mysvm We developed a python package called mysvm which contains three modules: features, svm, acc. These are used by the web application in feature extraction and finding genre. This package also contains many other functions to do complicated feature extraction and classification.\n├── acc.py ├── data │ ├── classifier_10class.pkl │ ├── classifier_10class_prob.pkl │ ├── cmpr.pkl │ └── Xall.npy ├── feature.py ├── __init__.py ├── svm.py feature This module is used to extract MFCC features from a given file. It contains the following functions.\n extract (file): Extract features from a given file. Files in other formats are converted to .wav format. Returns numpy array. extract_all (audio_dir): Extracts features from all files in a directory. extract_ratio (train_ratio, test_ratio, audio_dir) : Extract features from all files in a directory in a ratio. Returns two numpy arrays. geny(n): Generates Y values for n classes. Returns numpy array. gen_suby(sub, n): Generates Y values for a subset of classes. Returns numpy array. gen_labels( ): Returns a list of all genre labels. flattern( x) : Flatterns a numpy array.  svm A Support Vector Machine (SVM) is a discriminative classifier formally defined by a separating hyperplane. In other words, given labeled training data (supervised learning), the algorithm outputs an optimal hyperplane which categorizes new examples. This module contains various functions for classification using support vector machines.\n  poly(X,Y): Trains a poly kernel SVM by fitting X, Y dataset. Returns a trained poly kernel SVM classifier.\n  fit ( training_percentage, fold): Randomly choose songs from the dataset, and train the classifier. Accepts parameter: train_percentage, fold; Returns trained classifier.\n  getprob (filename): Find the probabilities for a song belongs to each genre. Returns a dictionary mapping genre names to probability and a list of top 3 genres which is having probability of more than 0.15.\n  random_cross_validation (train_percentage,fold): Randomly cross validate with training percentage and fold. Accepts parameter: train_percentage, fold;\n  findsubclass (class_count): Returns all possible ways we can combine the classes. Accepts an integer as class count. Returns numpy array of all possible combination.\n  gen_sub_data (class_l): Generate a subset of the dataset for the given list of classes. Returns numpy array.\n  fitsvm (Xall, Yall, class_l, train_percentage, fold): Fits a poly kernel svm and returns the accuracy. Accepts parameter: train_percentage; fold; Returns: classifier, Accuracy.\n  best_combinations (class_l, train_percentage, fold): Finds all possible combination of classes and the accuracy for the given number of classes Accepts: Training percentage, and number of folds Returns: A List of best combination possible for given the class count.\n  getgenre (filename): Accepts a filename and returns a genre label for a given file.\n  getgenreMulti (filename): Accepts a filename and returns top three genre labels based on the probability.\n  acc Module for finding the accuracy.\n get ( res, test ) :\nCompares two arrays and returns the accuracy of their match.  Results    Classifier Training Accuracy Testing Accuracy     K-Nearest Neighbors  53%   Logistic Regression 75.778% 54%   SVM Linear Kernel 99% 52%   SVM RBF Kernel 99% 12%   SVM Poly Kernel 99% 64%    6 genre classes we are getting an accuracy of 85%\nConclusion We have tried various machine learning algorithms for this project. Our aim is to get maximum accuracy. We have found from our research that we can a get maximum accuracy of 65% by using poly kernel SVM for 10 genre classes. We have also tried to find the best combination of genre classes which will result in maximum accuracy. If we choose 6 genre classes we were able to get an accuracy of 85%. We chose these labels for the Web Application [classical, hip-hop, jazz, metal, pop and rock] For some songs we can say that it has feature of multiple genres. So we have also tried to get multiple label outputs based on the probability.\n","wordCount":"1428","inLanguage":"en","datePublished":"2017-07-29T11:58:29+05:30","dateModified":"2017-07-29T11:58:29+05:30","author":{"@type":"Person","name":"Indrajith Indraprastham"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://indrajithi.github.io/posts/machine-learning-pproach-to-classify-music-based-on-genre/"},"publisher":{"@type":"Organization","name":"Blog of Indrajith Indraprastham","logo":{"@type":"ImageObject","url":"https://indrajithi.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://indrajithi.github.io/ accesskey=h title="< /> (Alt + H)">&lt; /></a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://indrajithi.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://indrajithi.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://indrajithi.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://indrajithi.github.io/posts/>Posts</a></div><h1 class=post-title>Machine Learning Approach to Classify Music Based on Genre</h1><div class=post-meta>July 29, 2017&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Indrajith Indraprastham</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#music-genre-classifier aria-label="Music Genre Classifier">Music Genre Classifier</a><ul><ul><li><a href=#demohttpsgenreclassifierherokuappcom aria-label=Demo><a href=https://genreclassifier.herokuapp.com/>Demo</a></a></li><li><a href=#table-of-contents aria-label="Table of Contents">Table of Contents</a></li></ul><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#installation aria-label=Installation>Installation</a></li><li><a href=#music-genre-classifier-1 aria-label="Music Genre Classifier">Music Genre Classifier</a></li><li><a href=#flow-chart aria-label="Flow Chart">Flow Chart</a></li><li><a href=#prototypehttpsgithubcomindrajithimusic-genre-classification-matlab aria-label=Prototype><a href=https://github.com/indrajithi/music-genre-classification-matlab>Prototype</a></a><ul><li><a href=#feature-extraction aria-label="Feature Extraction">Feature Extraction</a></li><li><a href=#principal-component-analysis aria-label="Principal Component Analysis.">Principal Component Analysis.</a></li><li><a href=#dimensionality-reduction aria-label="Dimensionality reduction">Dimensionality reduction</a></li><li><a href=#classification aria-label=Classification>Classification</a><ul><li><a href=#k-nearest-neighbors-knn aria-label="K-nearest neighbors (KNN)">K-nearest neighbors (KNN)</a></li><li><a href=#logistic-regression aria-label="Logistic Regression">Logistic Regression</a></li></ul></li></ul></li><li><a href=#python-package-mysvm aria-label="Python package mysvm">Python package <em>mysvm</em></a><ul><li><a href=#feature aria-label=feature><em>feature</em></a></li><li><a href=#svm aria-label=svm><em>svm</em></a></li><li><a href=#acc aria-label=acc><em>acc</em></a></li></ul></li></ul></li><li><a href=#results aria-label=Results>Results</a><ul><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=music-genre-classifier>Music Genre Classifier<a hidden class=anchor aria-hidden=true href=#music-genre-classifier>#</a></h1><p><img loading=lazy src=/mgc.jpg alt=Screenshot></p><h3 id=demohttpsgenreclassifierherokuappcom><a href=https://genreclassifier.herokuapp.com/>Demo</a><a hidden class=anchor aria-hidden=true href=#demohttpsgenreclassifierherokuappcom>#</a></h3><h3 id=table-of-contents>Table of Contents<a hidden class=anchor aria-hidden=true href=#table-of-contents>#</a></h3><ul><li><a href=#introduction>Introduction</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#installation>Installation</a></li><li><a href=#music-genre-classifier-app>Music Genre Classifier App</a></li><li><a href=#architecture>Architecture</a></li><li><a href=#flow-chart>Flow Chart</a></li><li><a href=#prototype>Prototype</a><ul><li><a href=#feature-extraction>Feature Extraction</a></li><li><a href=#principal-component-analysis>Principal Component Analysis.</a></li><li><a href=#dimensionality-reduction>Dimensionality reduction</a></li><li><a href=#classification>Classification</a><ul><li><a href=#k-nearest-neighbors-knn>K-nearest neighbors (KNN)</a></li><li><a href=#logistic-regression>Logistic Regression</a></li></ul></li></ul></li><li><a href=#python-package-mysvm>Python package mysvm</a><ul><li><a href=#feature><em>feature</em></a></li><li><a href=#svm><em>svm</em></a></li><li><a href=#acc><em>acc</em></a></li></ul></li><li><a href=#results>Results</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#license>License</a></li></ul><p>Music is categorized into subjective categories called genres. With the growth of the internet and multimedia, systems applications that deal with the musical databases gained importance and demand for Music Information Retrieval (MIR) applications increased.</p><p>Musical genres have no strict definitions and boundaries as they arise through a complex interaction between the public, marketing, historical, and cultural factors. We are going to create an application that accepts a music file and classify it in to genres.</p><h2 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h2><ul><li>Django (1.11)</li><li>Numpy (1.12.1)</li><li>Scikit-Learn (0.18.1)</li><li>Scipy (0.19.0)</li><li>Python-Speech-Features (0.5)</li><li>Pydub (0.18.0)</li></ul><h2 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h2><ul><li><code>git clone https://github.com/indrajithi/mgc-django.git</code></li><li><code>pip install -r requirements.txt</code></li><li><code>python manage.py migrate</code></li><li><code>python manage.py runserver</code></li><li><em>App will run on</em> <code>localhost:8000</code></li></ul><h2 id=music-genre-classifier-1>Music Genre Classifier<a hidden class=anchor aria-hidden=true href=#music-genre-classifier-1>#</a></h2><p>Our app is written in Python using Django framework. We are using a trained <code>Poly Kernel SVM</code> for finding the genre.</p><p>Our web application uses the package <code>mysvm</code> which we developed to extract features and to find the genre.</p><h2 id=flow-chart>Flow Chart<a hidden class=anchor aria-hidden=true href=#flow-chart>#</a></h2><p><img loading=lazy src=/flowchart_mgc.png alt="Flow Chart"></p><p>We have developed a python package called <a href=https://github.com/indrajithi/mgc-python>mysvm</a> for extracting features and classifying music. This package is added to our App. On receiving a request for genre label, we convert the file to <code>.wav</code> if it is in other format. Then the features are extracted from the audio file using <code>mysvm.feature.extract (filename)</code>. Genre labels can be found by <code>mysvm.svm.getGenre(filename)</code> function call. If multi option is selected by the user then <code>mysvm.svm.getMultiGenre(filename)</code> function is called.</p><h2 id=prototypehttpsgithubcomindrajithimusic-genre-classification-matlab><a href=https://github.com/indrajithi/music-genre-classification-matlab>Prototype</a><a hidden class=anchor aria-hidden=true href=#prototypehttpsgithubcomindrajithimusic-genre-classification-matlab>#</a></h2><p>We need to find the best classification algorithm that can be used in our App. Matlab is ideal to implement machine learning algorithms in minimum lines of code. Before making the App in python we made a prototype in Matlab.</p><h3 id=feature-extraction>Feature Extraction<a hidden class=anchor aria-hidden=true href=#feature-extraction>#</a></h3><p>We chose to extract MFCC from the audio files as the feature. For finding MFCC in Matlab, we have used HTK MFCC MATLAB toolkit. The output will be a matrix of 13<em>n dimensional vector. Where n depends on the total duration of the audio. 13</em>(100*sec).<br>While feature extraction we were getting ‘nan’(not a number) and infinity in the output. This is usually caused be a division by zero or a very small number closed to 0 resulting in infinity/nan in the output. This could be a regular result or some algorithm or implementation error in the MFCC toolkit. To overcome this situation, we have set nan or infinity entries in the feature array to 0.</p><h3 id=principal-component-analysis>Principal Component Analysis.<a hidden class=anchor aria-hidden=true href=#principal-component-analysis>#</a></h3><p>Principal component analysis (PCA) is a statistical procedure that uses an orthogonal transformation to convert a set of observations of possibly correlated variables into a set of values of linearly uncorrelated variables called principal components (or sometimes, principal modes of variation) [7]. After doing a PCA on the data we got 90% variance and should reduce the feature dimension.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab>[input2, eigvec, eigvalue] = pca (ds. input);
cumvar = cumsum(eigvalue); <span style=color:#f92672>//</span>cumulative sum n(n<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
cumvarpercent = cumvar<span style=color:#f92672>/</span>cumvar(<span style=color:#66d9ef>end</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>;
</code></pre></div><h3 id=dimensionality-reduction>Dimensionality reduction<a hidden class=anchor aria-hidden=true href=#dimensionality-reduction>#</a></h3><p>Various researchers take statistics such as mean variance IQR, etc., to reduce the feature dimension. Some researchers model it using multivariate regression and some fit it to a Gaussian mixture model. Here we are taking the mean and upper diagonal variance of 13*n MFCC coefficients. The result is a feature vector of size 104.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=color:#75715e>%Reducing Feature Dimeansion</span>
mf = mean(mm,<span style=color:#ae81ff>2</span>); <span style=color:#75715e>%row mean</span>
cf = cov(mm<span style=color:#f92672>&#39;</span>); <span style=color:#75715e>% covariance</span>
ff = mf;
   <span style=color:#66d9ef>for</span> i=<span style=color:#ae81ff>0</span>:(size(mm,<span style=color:#ae81ff>1</span>)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
    ff = [ff;diag(cf,i)]; <span style=color:#75715e>%use diagonals </span>
   <span style=color:#66d9ef>end</span>
t(:,<span style=color:#66d9ef>end</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) = ff(:,<span style=color:#ae81ff>1</span>);
</code></pre></div><h3 id=classification>Classification<a hidden class=anchor aria-hidden=true href=#classification>#</a></h3><h4 id=k-nearest-neighbors-knn>K-nearest neighbors (KNN)<a hidden class=anchor aria-hidden=true href=#k-nearest-neighbors-knn>#</a></h4><p>Principle is that the data instance of the same class should be closer in the feature space.
For a given data point x of unknown class, we can compute the distance between x and all
the data points in the training data and assign the class determined by k nearest points of x.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab>Suppose we are given training dataset of n points.
{(x1,y1),(x2,y2)…(xn,yn)}
    Where (xi,yi) represents data pair i.
xi<span style=color:#f92672>-</span> feature vector
yi<span style=color:#f92672>-</span> target class
</code></pre></div><p>For a new data point x the most likely class is determined by finding the distance from all training data points (Euclidian distance). The output class will be the class which k nearest neighbors belongs to. K is a predefined integer (k=1, k=2, k=3.)</p><h4 id=logistic-regression>Logistic Regression<a hidden class=anchor aria-hidden=true href=#logistic-regression>#</a></h4><p>Logistic Regression is one of the widely used classification algorithm. This algorithm is used in medical as well as business fields for analytics and classification. This model has the hypothesis function <code>0 ≤h (x) ≤ 1.</code> Where <code>hθ(x) = 11 + e-θTx </code>called as Sigmoid or Logistic Function. For binary class classification<code> y ∈{0, 1}</code>. The output of this classifier will be a probability of the given input belonging to class 1. If<code>hθ(x)</code>outputs 0.7 it means that the given input has 70% chance of belonging to class 1. Since we have 10 genre classes <code>y ∈{0, 1 .. 9}</code>we used one-vs-all method for classification.</p><h2 id=python-package-mysvm>Python package <em>mysvm</em><a hidden class=anchor aria-hidden=true href=#python-package-mysvm>#</a></h2><p>We developed a python package called <code>mysvm</code> which contains three modules: <em>features, svm, acc</em>. These are used by the web application in feature extraction and finding genre. This package also contains many other functions to do complicated feature extraction and classification.</p><pre><code>├── acc.py
├── data
│   ├── classifier_10class.pkl
│   ├── classifier_10class_prob.pkl
│   ├── cmpr.pkl
│   └── Xall.npy
├── feature.py
├── __init__.py
├── svm.py
</code></pre><h3 id=feature><em>feature</em><a hidden class=anchor aria-hidden=true href=#feature>#</a></h3><p>This module is used to extract MFCC features from a given file. It contains the following functions.</p><ul><li><em><strong>extract (file):</strong></em>
Extract features from a given file. Files in other formats are converted to .wav format. Returns numpy array.</li><li><em><strong>extract_all (audio_dir):</strong></em>
Extracts features from all files in a directory.</li><li><em><strong>extract_ratio (train_ratio, test_ratio, audio_dir) :</strong></em>
Extract features from all files in a directory in a ratio. Returns two numpy arrays.</li><li><em><strong>geny(n):</strong></em>
Generates <code>Y</code> values for <code>n</code> classes. Returns numpy array.</li><li><em><strong>gen_suby(sub, n):</strong></em>
Generates <code>Y</code> values for a subset of classes. Returns numpy array.</li><li><em><strong>gen_labels( ):</strong></em>
Returns a list of all genre labels.</li><li><em><strong>flattern( x) :</strong></em>
Flatterns a numpy array.</li></ul><h3 id=svm><em>svm</em><a hidden class=anchor aria-hidden=true href=#svm>#</a></h3><p>A Support Vector Machine (SVM) is a discriminative classifier formally defined by a separating hyperplane. In other words, given labeled training data (supervised learning), the algorithm outputs an optimal hyperplane which categorizes new examples. This module contains various functions for classification using support vector machines.</p><ul><li><p><em><strong>poly(X,Y):</strong></em>
Trains a poly kernel SVM by fitting X, Y dataset. Returns a trained poly kernel SVM classifier.</p></li><li><p><em><strong>fit ( training_percentage, fold):</strong></em>
Randomly choose songs from the dataset, and train the classifier. Accepts parameter: <code>train_percentage, fold</code>; Returns trained classifier.</p></li><li><p><em><strong>getprob (filename):</strong></em>
Find the probabilities for a song belongs to each genre. Returns a dictionary mapping genre names to probability and a list of top 3 genres which is having probability of more than 0.15.</p></li><li><p><em><strong>random_cross_validation (train_percentage,fold):</strong></em>
Randomly cross validate with training percentage and fold. Accepts parameter: <code>train_percentage, fold</code>;</p></li><li><p><em><strong>findsubclass (class_count):</strong></em>
Returns all possible ways we can combine the classes. Accepts an integer as class count. Returns numpy array of all possible combination.</p></li><li><p><em><strong>gen_sub_data (class_l):</strong></em>
Generate a subset of the dataset for the given list of classes. Returns numpy array.</p></li><li><p><em><strong>fitsvm (Xall, Yall, class_l, train_percentage, fold):</strong></em>
Fits a poly kernel svm and returns the accuracy. Accepts parameter: <code>train_percentage; fold</code>; Returns: classifier, Accuracy.</p></li><li><p><em><strong>best_combinations (class_l, train_percentage, fold):</strong></em>
Finds all possible combination of classes and the accuracy for the given number of classes Accepts: Training percentage, and number of folds Returns: A List of best combination possible for given the class count.</p></li><li><p><em><strong>getgenre (filename):</strong></em>
Accepts a filename and returns a genre label for a given file.</p></li><li><p><em><strong>getgenreMulti (filename):</strong></em>
Accepts a filename and returns top three genre labels based on the probability.</p></li></ul><h3 id=acc><em>acc</em><a hidden class=anchor aria-hidden=true href=#acc>#</a></h3><p>Module for finding the accuracy.</p><ul><li><strong>get ( res, test ) :</strong><br>Compares two arrays and returns the accuracy of their match.</li></ul><h1 id=results>Results<a hidden class=anchor aria-hidden=true href=#results>#</a></h1><table><thead><tr><th style=text-align:center>Classifier</th><th style=text-align:center>Training Accuracy</th><th style=text-align:center>Testing Accuracy</th></tr></thead><tbody><tr><td style=text-align:center>K-Nearest Neighbors</td><td style=text-align:center></td><td style=text-align:center>53%</td></tr><tr><td style=text-align:center>Logistic Regression</td><td style=text-align:center>75.778%</td><td style=text-align:center>54%</td></tr><tr><td style=text-align:center>SVM Linear Kernel</td><td style=text-align:center>99%</td><td style=text-align:center>52%</td></tr><tr><td style=text-align:center>SVM RBF Kernel</td><td style=text-align:center>99%</td><td style=text-align:center>12%</td></tr><tr><td style=text-align:center><strong>SVM Poly Kernel</strong></td><td style=text-align:center><strong>99%</strong></td><td style=text-align:center><strong>64%</strong></td></tr></tbody></table><p><strong>6 genre classes we are getting an accuracy of 85%</strong></p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>We have tried various machine learning algorithms for this project. Our aim is to get maximum accuracy. We have found from our research that we can a get maximum accuracy of <code>65%</code> by using <code>poly kernel SVM</code> for 10 genre classes. We have also tried to find the best combination of genre classes which will result in maximum accuracy. If we choose 6 genre classes we were able to get an accuracy of <code>85%</code>. We chose these labels for the Web Application [classical, hip-hop, jazz, metal, pop and rock]
For some songs we can say that it has feature of multiple genres. So we have also tried to get multiple label outputs based on the probability.</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://indrajithi.github.io/posts/computerized-adaptive-test/><span class=title>« Prev Page</span><br><span>How to develop a Computerized Adaptive Test (CAT)</span></a>
<a class=next href=https://indrajithi.github.io/posts/music-visualizer-in-c-using-opengl/><span class=title>Next Page »</span><br><span>Music Visualizer in C Using OpenGL</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on twitter" href="https://twitter.com/intent/tweet/?text=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre&url=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f&title=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre&summary=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre&source=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on reddit" href="https://reddit.com/submit?url=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f&title=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on whatsapp" href="https://api.whatsapp.com/send?text=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre%20-%20https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Machine Learning Approach to Classify Music Based on Genre on telegram" href="https://telegram.me/share/url?text=Machine%20Learning%20Approach%20to%20Classify%20Music%20Based%20on%20Genre&url=https%3a%2f%2findrajithi.github.io%2fposts%2fmachine-learning-pproach-to-classify-music-based-on-genre%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://indrajithi.github.io/>Blog of Indrajith Indraprastham</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>